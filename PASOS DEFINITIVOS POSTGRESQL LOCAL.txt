
ðŸš€ PARA INSTANCIA VIRGEN (RECOMENDADO)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”


# Detener todos los contenedores
sudo docker stop $(sudo docker ps -aq)

# Eliminar todos los contenedores
sudo docker rm -f $(sudo docker ps -aq)

# Eliminar todas las imÃ¡genes
sudo docker rmi -f $(sudo docker images -q)

# Limpiar volÃºmenes huÃ©rfanos (opcional)
sudo docker volume prune -f

# Limpiar redes huÃ©rfanas (opcional)
sudo docker network prune -f

# Limpieza completa del sistema (opcional - MÃS AGRESIVO)
sudo docker system prune -a --volumes -f




echo "FRONTEND_HOSTS=http://localhost:4200,http://localhost:8000" >> api/.env


docker compose up -d


1. Limpiar base de datos completamente:

docker compose exec -T database psql -U fleetbase -d fleetbase << 'SQL'
DROP SCHEMA public CASCADE;
CREATE SCHEMA public;
GRANT ALL ON SCHEMA public TO fleetbase;
GRANT ALL ON SCHEMA public TO public;
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";
CREATE EXTENSION IF NOT EXISTS "postgis";
CREATE EXTENSION IF NOT EXISTS "pg_trgm";
SQL

2. Crear tabla migrations:

docker compose exec application php artisan migrate:install


3. Ejecutar script completo:

# OpciÃ³n 1: Ejecutar directamente
./scripts/migrate-all-robust.sh



# OpciÃ³n 2: Con bash (como antes)
bash scripts/migrate-all-robust.sh

# Si falla:
## '/mnt/g/Users/GAMEMAX/Documents/CREAI/fleetbase-repo/scripts/apply-all-pgsql-fixes.sh'
bash scripts/apply-all-pgsql-fixes.sh

# Luego por segunda vez:
bash scripts/migrate-all-robust.sh



# OpciÃ³n 3: Desde el directorio scripts
cd scripts && ./migrate-all-robust.sh


##'/mnt/g/Users/GAMEMAX/Documents/CREAI/fleetbase-repo/scripts/create-permissions.sh'


4. Ejecutar los dos ultimos

bash scripts/create-permissions.sh

bash scripts/create-roles.sh
